<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <div>
    <button onclick="connectToWebSocket()">Connect</button>
    <p id="system_type">系统类型</p>
    <p id="z">z轴</p>
    <p id="x">x轴</p>
    <p id="y">y轴</p>
    <label for="wsUrl">WebSocket URL:</label>
    <input type="text" id="wsUrl" placeholder="Enter WebSocket URL">
    <label for="wsPort">Port:</label>
    <input type="text" id="wsPort" placeholder="Enter port number">
  </div>
  
  <script>
    var z = document.getElementById('z');
    var x = document.getElementById('x');
    var y = document.getElementById('y');
    var system_type = document.getElementById('system_type');
    var wsUrlInput = document.getElementById('wsUrl');
    var wsPortInput = document.getElementById('wsPort');
    var ws;
    
    function getSystemType() {
        var ua = navigator.userAgent;
        // Check for different operating systems
        if (ua.indexOf('Android') > -1) {
            return 'Android';
        } else if (ua.indexOf('iPad') > -1 || ua.indexOf('iPhone') > -1 || ua.indexOf('iPod') > -1) {
            return 'iOS';
        } else if (ua.indexOf('Windows') > -1) {
            return 'Windows';
        } else if (ua.indexOf('Mac') > -1) {
            return 'macOS';
        } else if (ua.indexOf('Linux') > -1) {
            return 'Linux';
        } else {
            return 'Other';
        }
    }

    function connectToWebSocket() {
      var system_name = getSystemType();
      system_type.innerText = '系统类型: ' + system_name;

      var wsUrl = wsUrlInput.value;
      var wsPort = wsPortInput.value;

      ws = new WebSocket('ws://' + wsUrl + ':' + wsPort);

      ws.onopen = function() {
        console.log('Connected to WebSocket server');
        sendXYZData();
      };

      ws.onclose = function() {
        console.log('Disconnected from WebSocket server');
      };
    }

    function sendXYZData() {
      setInterval(function() {
        var alpha = Math.round(Math.random() * 360 * 1000) / 1000; // Random value for demonstration
        var beta = Math.round(Math.random() * 180 * 1000) / 1000; // Random value for demonstration
        var gamma = Math.round(Math.random() * 90 * 1000) / 1000; // Random value for demonstration

        if (ws.readyState === WebSocket.OPEN) {
          ws.send(JSON.stringify({ alpha: alpha, beta: beta, gamma: gamma }));
        }
      }, 1000);
    }

    function getDeviceOrientation() {
      if ('getDeviceOrientation' in navigator) {
          navigator.getDeviceOrientation().then(function (orientation) {
              updateText(orientation);
          });
      } else {
          alert('getDeviceOrientation 接口不支持');
      }
    }

    function updateText(orientation) {
      x.innerText = 'x轴 ' + orientation.x.toFixed(3);
      y.innerText = 'y轴 ' + orientation.y.toFixed(3);
      z.innerText = 'z轴 ' + orientation.z.toFixed(3);
    }
  </script>
</body>
</html>
